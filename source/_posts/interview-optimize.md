---
title: 面试题系列之前端性能优化
categories: []
tags: [面试题]
comments: false
date: 2019-08-08 16:38:23
img:
---
## 前端性能优化

### 前端缓存

> 缓存是性能优化中非常重要的一环，浏览器的缓存机制也是非常重要的知识点。

下面我们通过三个部分来说说浏览器的缓存：

* 强缓存
* 协商缓存
* 缓存位置

#### 强缓存

浏览器中的缓存作用分为两种情况：一种是需要发送HTTP请求，一种是不需要发送。

首先通过相应的字段来检查强缓存，这个阶段不需要发送HTTP请求。

`HTTP/1.0`时期，使用的字段是**Expires**
`HTTP/1.1`时期，使用的字段是**Cache-Control**

**Expires**
`Expires`即过期时间，存在于服务端返回的响应头中，告诉浏览器在这个过期时间之前可以直接从缓存里面获取数据，无需再次请求。如:

``` js
Expires: Wed, 22 Nov 2019 08:41:00 GMT
```

表示资源在2019年11月22号8点41分过期，过期了就得向服务端发请求。

**弊端：** 如果服务器时间和浏览器的时间不一致，那服务器返回的这个过期时间是不准确的。因此这种方式后来在HTTP/1.1版本中弃用了。

**Cache-Control**
它和Expires的本质区别是：
`Expires`采用具体的过期时间点来控制缓存，而`Cache-Control`采用过期时长来控制缓存，对应字段是`max-age`。如：

``` js
Cache-Control:max-age=3600
```

代表这个响应返回后在 3600 秒，也就是一个小时之内可以直接使用缓存。

它除了max-age属性之外，还可以组合非常多的指令，来完成更多场景的缓存判断，下面让我们来了解一些关键的属性：

* public: 客户端和代理服务器都可以缓存。因为一个请求可能要经过不同的代理服务器最后才到达目标服务器，那么结果就是不仅仅浏览器可以缓存数据，中间的任何代理节点都可以进行缓存。
* private：这种情况就是只有浏览器能缓存了，中间的代理服务器不能缓存。
* no-cache: 跳过当前的强缓存，发送HTTP请求，即直接进入协商缓存阶段。
* no-store：非常粗暴，不进行任何形式的缓存。
* s-maxage：这和max-age长得比较像，但是区别在于s-maxage是针对代理服务器的缓存时间。
* must-revalidate: 是缓存就会有过期的时候，加上这个字段一旦缓存过期，就必须回到源服务器验证。

**注：**

* 当Expires和Cache-Control同时存在的时候，Cache-Control会优先判断。
* 当资源缓存时间过期了，也就是强缓存失效了，就会进入`协商缓存`

#### 协商缓存
